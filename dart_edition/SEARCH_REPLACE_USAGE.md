# 搜尋與取代功能使用指南

## 快速開始

### 1. 開啟搜尋取代視窗

有兩種方式可以開啟搜尋取代視窗：

1. **使用工具列按鈕**
   - 點擊頂部工具列的搜尋圖示 🔍
   - 如果您不在編輯器頁面，會自動切換到編輯器並顯示搜尋視窗

2. **在編輯器頁面**
   - 如果已經在編輯器頁面，點擊搜尋按鈕會切換視窗的顯示/隱藏狀態

### 2. 基本搜尋

#### 簡單搜尋
1. 在「尋找內容」輸入框輸入要搜尋的文字
2. 點擊向下箭頭 ⬇️ 尋找下一個
3. 點擊向上箭頭 ⬆️ 尋找上一個

**範例：**
```
尋找內容: "物語"
結果: 找到第 1 個，共 5 個
```

#### 循環搜尋
- 搜尋會自動循環
- 到達最後一個匹配項後，按下一個會回到第一個
- 到達第一個匹配項後，按上一個會回到最後一個

### 3. 使用取代功能

#### 單次取代
1. 點擊展開按鈕 ⬇️ 顯示取代選項
2. 在「取代為」輸入框輸入取代文字
3. 先用搜尋找到要取代的文字
4. 點擊取代按鈕 🔄（單一圖示）
5. 系統會自動尋找下一個匹配項

**範例：**
```
尋找內容: "她"
取代為: "他"
操作: 點擊取代按鈕
結果: 已取代 1 個（並自動尋找下一個）
```

#### 全部取代
1. 在「尋找內容」輸入要取代的文字
2. 在「取代為」輸入新文字
3. 點擊全部取代按鈕 ✓✓（雙重勾選圖示）
4. 系統會一次取代所有匹配項

**範例：**
```
尋找內容: "主角"
取代為: "男主角"
操作: 點擊全部取代按鈕
結果: 已取代 15 個
```

### 4. 搜尋選項

點擊齒輪圖示 ⚙️ 顯示進階搜尋選項：

#### 大小寫相同
- **用途**: 區分大小寫搜尋
- **範例**: 
  - 開啟: "Hero" 不會匹配 "hero"
  - 關閉: "Hero" 會匹配 "hero", "HERO", "HerO"

#### 全字拼寫需相符
- **用途**: 只匹配完整的單詞（主要用於英文）
- **範例**: 
  - 開啟: "cat" 不會匹配 "catalog"
  - 關閉: "cat" 會匹配 "cat", "catalog", "scatter"

#### 使用萬用字元
- **用途**: 使用 `?` 和 `*` 進行模糊搜尋
- **符號說明**:
  - `?`: 代表任意單一字元
  - `*`: 代表任意多個字元（包括零個）
- **範例**:
  ```
  尋找: "物語*助手"     → 匹配 "物語助手", "物語寫作助手"
  尋找: "第?章"         → 匹配 "第一章", "第1章", "第二章"
  尋找: "角色*設定"     → 匹配 "角色設定", "角色背景設定"
  ```

#### 全半形須相符
- **用途**: 檢查字元的全形/半形是否匹配
- **範例**:
  - 開啟: "１" 不會匹配 "1"
  - 關閉: "１" 會匹配 "1"

#### 略過標點符號
- **用途**: 搜尋時忽略所有標點符號
- **支援的標點**: 英文標點 + 中文標點
- **範例**:
  ```
  尋找: "你好嗎"
  開啟後匹配: "你好嗎", "你好，嗎", "你好！嗎？"
  ```

#### 略過空白字元
- **用途**: 搜尋時忽略所有空白字元（空格、Tab、換行等）
- **範例**:
  ```
  尋找: "物語助手"
  開啟後匹配: "物語助手", "物語 助手", "物語  助手"
  ```

## 進階使用技巧

### 1. 組合使用多個選項

您可以同時開啟多個搜尋選項：

**範例 1: 不分大小寫 + 略過標點**
```
尋找: "what"
選項: ✓ 略過標點符號
匹配: "What", "what?", "What!", "WHAT."
```

**範例 2: 萬用字元 + 全字匹配**
```
尋找: "第*章"
選項: ✓ 使用萬用字元 + ✓ 全字拼寫需相符
匹配: "第一章", "第二章" (作為獨立單詞)
不匹配: "在第一章中" (不是完整單詞)
```

### 2. 批量取代工作流程

**情境**: 將所有的"她"改成"他"，但要檢查每一個

1. 輸入「尋找內容」: "她"
2. 輸入「取代為」: "他"
3. 點擊「尋找下一個」查看第一個
4. 如果要取代，點擊「取代」（會自動跳到下一個）
5. 如果不要取代，點擊「尋找下一個」跳過
6. 重複步驟 4-5 直到完成

### 3. 使用萬用字元的實際案例

**案例 1: 尋找所有章節標題**
```
尋找: "第*章*"
選項: ✓ 使用萬用字元
結果: "第一章 開始", "第二章 冒險", "第三章 結局"
```

**案例 2: 尋找所有對話**
```
尋找: "「*」"
選項: ✓ 使用萬用字元
結果: 所有用「」包圍的對話
```

**案例 3: 尋找角色名稱變體**
```
尋找: "小*"
選項: ✓ 使用萬用字元
結果: "小明", "小美", "小華"
```

## 常見問題 (FAQ)

### Q1: 為什麼找不到我輸入的文字？
**A**: 請檢查：
1. 是否有開啟「大小寫相同」選項
2. 是否有開啟「全半形須相符」選項
3. 確認編輯器中確實有該文字
4. 嘗試關閉所有搜尋選項後再試

### Q2: 取代按鈕為什麼無效？
**A**: 取代功能需要：
1. 先使用搜尋找到匹配項（文字會被選中）
2. 確保當前選中的文字匹配搜尋內容
3. 如果沒有選取，點擊取代會自動執行搜尋

### Q3: 全部取代可以撤銷嗎？
**A**: 
- Flutter TextField 內建支援 Undo/Redo
- 使用 Ctrl+Z (Windows) 或 Cmd+Z (Mac) 可以撤銷
- 建議重要內容先儲存檔案再進行全部取代

### Q4: 萬用字元搜尋很慢怎麼辦？
**A**: 
- 萬用字元使用正則表達式，大文本時可能較慢
- 嘗試更具體的搜尋模式
- 避免使用 "*" 在開頭（如 "*text"）

### Q5: 可以搜尋換行嗎？
**A**: 
- 目前版本不直接支援搜尋換行符號
- 可以使用「略過空白字元」選項來忽略換行

## 鍵盤快捷鍵（未來功能）

以下快捷鍵尚未實作，作為未來改進方向：

- `Ctrl+F`: 開啟搜尋視窗
- `F3` 或 `Enter`: 尋找下一個
- `Shift+F3`: 尋找上一個
- `Ctrl+H`: 開啟取代功能
- `Ctrl+Shift+H`: 全部取代
- `Esc`: 關閉搜尋視窗

## 最佳實踐

### 1. 搜尋前先儲存
建議在進行大量取代前先儲存檔案，以防意外。

### 2. 使用適當的選項
- 英文內容：考慮使用「全字拼寫需相符」
- 中文內容：考慮使用「略過標點符號」
- 混合內容：謹慎使用「全半形須相符」

### 3. 段落取代流程
對於需要審查的取代：
1. 先用「尋找下一個」預覽所有匹配項
2. 使用「取代」逐一確認
3. 只在確定時才使用「全部取代」

### 4. 備份重要內容
- 執行全部取代前先儲存檔案
- 考慮使用版本控制（Git）
- 重要修改前可以另存新檔

## 故障排除

### 搜尋視窗不顯示
1. 確認您在編輯器頁面
2. 再次點擊搜尋按鈕切換顯示

### 搜尋結果不正確
1. 關閉所有搜尋選項
2. 使用最簡單的搜尋字串測試
3. 逐步開啟選項確認哪個導致問題

### 效能問題
1. 避免在超大文件中使用萬用字元
2. 使用更精確的搜尋字串
3. 考慮分段搜尋

## 回饋與建議

如果您有任何問題或建議，歡迎：
1. 提交 Issue
2. 提供使用回饋
3. 建議新功能

---

*最後更新: 2025年10月30日*
